<!-- {{datos}} -->
<!-- <div class="p-3">
  <p-toast></p-toast>

  <div class="card">
    <h1 class="text-5xl">Materias</h1>
    <p-toolbar styleClass="mb-4 ">
      <ng-template pTemplate="left">
        <button
          pButton
          pRipple
          label="Nuevo"
          icon="pi pi-plus"
          class="p-button-success mr-2"
          (click)="openNew()"
        ></button>
        <button
          pButton
          pRipple
          [label]="'Eliminar'"
          icon="pi pi-trash"
          class="p-button-danger"
          (click)="deleteSelectedProducts()"
          [disabled]="!selectedProducts || !selectedProducts.length"
        ></button>
      </ng-template>

    </p-toolbar>
    
    <p-table
      #dt
      [value]="datos"
      [rows]="10"
      [paginator]="true"
      [globalFilterFields]="[
        'name',
        'country.name',
        'representative.name',
        'status'
      ]"
      [(selection)]="selectedProducts"
      [rowHover]="true"
      dataKey="id"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
      [showCurrentPageReport]="true"
    >
      <ng-template pTemplate="caption">
        <div class="p-d-flex p-ai-center p-jc-between">
          <span class="p-input-icon-left">
            <i class="pi pi-search"></i>
            <input
              pInputText
              type="text"
              (input)="dt.filterGlobal(getEventValue($event), 'contains')"
              placeholder="Search..."
            />
          </span>
        </div>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th style="width: 3rem">
            <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
          </th>
          <th pSortableColumn="name">
            Nombre <p-sortIcon field="name"></p-sortIcon>
          </th>
          <th pSortableColumn="price">
            Codigo-Materia<p-sortIcon field="price"></p-sortIcon>
          </th>
          <th pSortableColumn="category">
            Año<p-sortIcon field="category"></p-sortIcon>
          </th>
          <th pSortableColumn="rating">
            Docente <p-sortIcon field="rating"></p-sortIcon>
          </th>
          <th pSortableColumn="inventoryStatus">
            Estado <p-sortIcon field="inventoryStatus"></p-sortIcon>
          </th>
          <th></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-datos>
        <tr>
          <td>
            <p-tableCheckbox [value]="datos"></p-tableCheckbox>
          </td>
          <td>{{ datos.nombre }}</td>
          <td>{{ product.price }}</td>
          <td>{{ product.category }}</td>
          <td><p>Sin asignar</p></td>
          <td>
            <span
              
              >{{ product.inventoryStatus }}</span
            >
          </td>
          <td>
            <button
              pButton
              pRipple
              icon="pi pi-pencil"
              class="p-button-rounded p-button-success p-mr-2"
              (click)="editProduct(product)"
            ></button>
            <button
              pButton
              pRipple
              icon="pi pi-trash"
              class="p-button-rounded p-button-warning"
              (click)="deleteProduct(product)"
            ></button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="summary">
        <div class="p-d-flex p-ai-center p-jc-between">
          In total there are {{ products ? products.length : 0 }} products.
        </div>
      </ng-template>
    </p-table>
  </div>

  <p-dialog
    [(visible)]="productDialog"
    [style]="{ width: '450px' }"
    header="Product Details"
    [modal]="true"
    styleClass="p-fluid"
  >
    <ng-template pTemplate="content">
      <img
        [src]="'assets/showcase/images/demo/product/' + product.image"
        [alt]="product.image"
        class="product-image"
        *ngIf="product.image"
      />
      <div class="field">
        <label for="name">Name</label>
        <input
          type="text"
          pInputText
          id="name"
          [(ngModel)]="product.name"
          required
          autofocus
        />
        <small class="p-error" *ngIf="submitted && !product.name"
          >Name is required.</small
        >
      </div>
      <div class="field">
        <label for="description">Description</label>
        <textarea
          id="description"
          pInputTextarea
          [(ngModel)]="product.description"
          required
          rows="3"
          cols="20"
        ></textarea>
      </div>

      <div class="field">
        <label for="inventoryStatus">Inventory Status</label>
        <p-dropdown
          [(ngModel)]="product.inventoryStatus"
          inputId="inventoryStatus"
          optionValue="label"
          [options]="statuses"
          placeholder="Select"
        >
          <ng-template pTemplate="selectedItem">
            <span
              *ngIf="product && product.inventoryStatus"
              [class]="
                'product-badge status-' + product.inventoryStatus.toLowerCase()
              "
              >{{ product.inventoryStatus }}</span
            >
          </ng-template>
          <ng-template let-option pTemplate="item">
            <span [class]="'product-badge status-' + option.value">{{
              option.label
            }}</span>
          </ng-template>
        </p-dropdown>
      </div>

      <div class="field">
        <label class="mb-3">Category</label>
        <div class="formgrid grid">
          <div class="field-radiobutton col-6">
            <p-radioButton
              id="category1"
              name="category"
              value="Accessories"
              [(ngModel)]="product.category"
            ></p-radioButton>
            <label for="category1">Accessories</label>
          </div>
          <div class="field-radiobutton col-6">
            <p-radioButton
              id="category2"
              name="category"
              value="Clothing"
              [(ngModel)]="product.category"
            ></p-radioButton>
            <label for="category2">Clothing</label>
          </div>
          <div class="field-radiobutton col-6">
            <p-radioButton
              id="category3"
              name="category"
              value="Electronics"
              [(ngModel)]="product.category"
            ></p-radioButton>
            <label for="category3">Electronics</label>
          </div>
          <div class="field-radiobutton col-6">
            <p-radioButton
              id="category4"
              name="category"
              value="Fitness"
              [(ngModel)]="product.category"
            ></p-radioButton>
            <label for="category4">Fitness</label>
          </div>
        </div>
      </div>

      <div class="formgrid grid">
        <div class="field col">
          <label for="price">Price</label>
          <p-inputNumber
            id="price"
            [(ngModel)]="product.price"
            mode="currency"
            currency="USD"
            locale="en-US"
          ></p-inputNumber>
        </div>
        <div class="field col">
          <label for="quantity">Quantity</label>
          <p-inputNumber
            id="quantity"
            [(ngModel)]="product.quantity"
          ></p-inputNumber>
        </div>
      </div>
    </ng-template>

    <ng-template pTemplate="footer">
      <button
        pButton
        pRipple
        label="Cancel"
        icon="pi pi-times"
        class="p-button-text"
        (click)="hideDialog()"
      ></button>
      <button
        pButton
        pRipple
        label="Save"
        icon="pi pi-check"
        class="p-button-text"
        (click)="saveProduct()"
      ></button>
    </ng-template>
  </p-dialog>

  
</div> -->
<form (ngSubmit)="guardarAsignatura()" [formGroup]="asignaturaForm">
  <p-dialog
    [(visible)]="productDialog"
    [style]="{ width: '450px' }"
    [header]="tituloModal"
    [modal]="true"
    styleClass="p-fluid"
  >
    <ng-template pTemplate="content">
      <div class="field">
        <label for="nombre">Nombre</label>
        <input
          type="text"
          pInputText
          id="nombre"
          formControlName="nombre"
          autofocus
          [ngClass]="{'ng-dirty':asignaturaForm.get('nombre')?.touched && asignaturaForm.get('nombre')?.errors?.['required']}"
        />
        <small
          class="p-error"
          *ngIf="asignaturaForm.get('nombre')?.touched && asignaturaForm.get('nombre')?.errors?.['required']"
          >Nombre is required.</small
        >
      </div>
      <!-- <div class="field">
        <label for="ciclo">Ciclo</label>
        <p-inputNumber
          inputId="integeronly"
          id="ciclo"
          formControlName="ciclo"
          autofocus
        >
        </p-inputNumber>
        <small class="p-error" *ngIf="submitted && !product.name"
          >Ciclo is required.</small
        >
      </div> -->
      <div class="field">
        <label for="siglaCodigo">Sigla-Codigo</label>
        <p-inputNumber
          inputId="integeronly"
          id="siglaCodigo"
          formControlName="siglaCodigo"
          autofocus
          prefix="MED-"
          [useGrouping]="false"
          [ngClass]="{'ng-dirty':asignaturaForm.get('siglaCodigo')?.touched && asignaturaForm.get('siglaCodigo')?.errors?.['required']}"
        >
        </p-inputNumber>
        <small class="p-error" *ngIf=":asignaturaForm.get('siglaCodigo')?.touched && asignaturaForm.get('siglaCodigo')?.errors?.['required']"
          >Sigla-Codigo is required.</small
        >
      </div>
      <div class="field">
        <label for="cargaHoraria">Carga Horaria</label>
        <p-inputNumber
          inputId="integeronly"
          id="cargaHoraria"
          formControlName="cargaHoraria"
          autofocus
          suffix=" Hrs"
          [ngClass]="{'ng-dirty':asignaturaForm.get('cargaHoraria')?.touched && asignaturaForm.get('cargaHoraria')?.errors?.['required']}"
        >
        </p-inputNumber>
        <small class="p-error" *ngIf="asignaturaForm.get('cargaHoraria')?.touched && asignaturaForm.get('cargaHoraria')?.errors?.['required']"
          >Carga Horariao is required.</small
        >
      </div>
      <div class="field">
        <label for="nMeses">N° Meses</label>
        <p-inputNumber
          inputId="integeronly"
          id="nMeses"
          formControlName="nMeses"
          autofocus
          suffix=" Meses"
          [ngClass]="{'ng-dirty':asignaturaForm.get('nMeses')?.touched && asignaturaForm.get('nMeses')?.errors?.['required']}"

        >
        </p-inputNumber>
        <small class="p-error" *ngIf="asignaturaForm.get('nMeses')?.touched && asignaturaForm.get('nMeses')?.errors?.['required']"
          >N° Meses is required.</small
        >
      </div>
      <!-- <div class="field">
      <label for="name">Prerequisito</label>
      <p-multiSelect [options]="listadocentes" [(ngModel)]="selectedPrerequisitos" optionLabel="nombre"></p-multiSelect>

      <small class="p-error" *ngIf="submitted && !product.name"
        >N° Meses is required.</small
      >
    </div> -->
      <div class="field">
        <label for="paralelo">Paralelo</label>
        <input
          type="paralelo"
          pInputText
          id="paralelo"
          formControlName="paralelo"
          placeholder="A"
          autofocus
          [ngClass]="{'ng-dirty':asignaturaForm.get('paralelo')?.touched && asignaturaForm.get('paralelo')?.errors?.['required']}"

        />
        <small class="p-error" *ngIf="asignaturaForm.get('paralelo')?.touched && asignaturaForm.get('paralelo')?.errors?.['required']"
          >Paralelo is required.</small
        >
      </div>

      <div class="field">
        <label for="docente">Docente</label>

        <!-- <p-dropdown [options]="listadocentes" [(ngModel)]="selectedDocente" optionLabel="nombre" appendTo="body"></p-dropdown> -->

        <p-dropdown
          appendTo="body"
          [options]="listadocentes"
          optionLabel="nombre"
          [filter]="true"
          filterBy="nombre"
          [showClear]="true"
          placeholder="Selecciona un Docente"
          formControlName="docente"
          optionValue="id"
          [ngClass]="{'ng-dirty':asignaturaForm.get('docente')?.touched && asignaturaForm.get('docente')?.errors?.['required']}"

        >
          <ng-template let-docente pTemplate="item">
            <div class="country-item">
              <div>{{ docente.nombre }}</div>
            </div>
          </ng-template>
        </p-dropdown>
        <small class="p-error" *ngIf="asignaturaForm.get('docente')?.touched && asignaturaForm.get('docente')?.errors?.['required']"
          >Docenteis required.</small
        >
      </div>
    </ng-template>

    <ng-template pTemplate="footer">
      <!-- <button
      type="button"
        pButton
        pRipple
        label="Cancelar"
        icon="pi pi-times"
        class="p-button-text"
        (click)="hideDialog()"
      ></button> -->
      <button
        [disabled]="!asignaturaForm.valid"
        type="submit"
        pButton
        pRipple
        label="Guardar"
        icon="pi pi-check"
        class="p-button-text"
      ></button>
    </ng-template>
  </p-dialog>
</form>
<p-toast></p-toast>

<p-confirmDialog #cd [style]="{ width: '50vw' }">
  <ng-template pTemplate="header">
    <h3>Eliminar</h3>
  </ng-template>
  <ng-template pTemplate="footer">
    <button
      type="button"
      pButton
      icon="pi pi-times"
      label="No"
      class="p-button-secondary"
      (click)="cd.reject()"
    ></button>
    <button
      type="button"
      pButton
      icon="pi pi-check"
      label="Si"
      class="p-button-danger"
      (click)="cd.accept()"
    ></button>
  </ng-template>
</p-confirmDialog>

<div class="p-3 card">
  <!-- <ul *ngFor="let item of datos">
    <li> {{item.nombre}}</li>
  </ul> -->

  <p-table
    [value]="datos"
    [tableStyle]="{ 'min-width': '300px' }"
    responsiveLayout="stack"
    [breakpoint]="'960px'"
    styleClass="p-datatable-sm p-datatable-striped"
    [(selection)]="selectedProducts"
  >
    <ng-template pTemplate="caption">
      <div class="flex align-items-center justify-content-between">
        Asignaturas
        <button
          pButton
          pRipple
          [label]="'Eliminar'"
          icon="pi pi-trash"
          class="p-button-danger"
          (click)="deleteSelectedAsignatura()"
          [disabled]="!selectedProducts || !selectedProducts.length"
        ></button>
        <button
          pButton
          pRipple
          label="New"
          icon="pi pi-plus"
          class="p-button-success p-mr-2"
          (click)="nuevoAsignatura()"
        ></button>
      </div>
    </ng-template>
    <ng-template pTemplate="header" let-columns>
      <tr>
        <th style="width: 4rem">
          <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
        </th>
        <th pSortableColumn="nombre">
          Nombre<p-sortIcon field="nombre"></p-sortIcon>
        </th>
        <th pSortableColumn="siglaCodigo">
          Sigla-Codigo<p-sortIcon field="siglaCodigo"></p-sortIcon>
        </th>
        <th pSortableColumn="cargaHoraria">
          Carga Horaria<p-sortIcon field="cargaHoraria"></p-sortIcon>
        </th>
        <th pSortableColumn="nMeses">
          N° Meses<p-sortIcon field="nMeses"></p-sortIcon>
        </th>
        <th pSortableColumn="paralelo">
          Paralelo<p-sortIcon field="paralelo"></p-sortIcon>
        </th>
        <th pSortableColumn="docente.iduser.nombres">
          Docente<p-sortIcon field="docente.iduser.nombres"></p-sortIcon>
        </th>
        <th pSortableColumn="createdAt">
          Fecha de creacion<p-sortIcon field="createdAt"></p-sortIcon>
        </th>
        <th>Acciones</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-dato let-columns="columns">
      <tr>
        <td>
          <p-tableCheckbox [value]="dato"></p-tableCheckbox>
        </td>
        <td><span class="p-column-title">Nombre</span>{{ dato.nombre }}</td>
        <td>
          <span class="p-column-title">Sigla-Codigo</span>{{ dato.siglaCodigo }}
        </td>
        <td>
          <span class="p-column-title">Carga Horaria</span
          >{{ dato.cargaHoraria }}
        </td>
        <td><span class="p-column-title">N° Meses</span>{{ dato.nMeses }}</td>
        <td><span class="p-column-title">Paralelo</span>{{ dato.paralelo }}</td>
        <td>
          <span class="p-column-title">Docente</span
          >{{ dato.docente.iduser.nombres }}
        </td>
        <td><span class="p-column-title">N° Meses</span>{{ dato.createdAt | date:'short'  }}</td>
        <td class="flex align-content-center justify-content-center">
          <p-button
            styleClass="p-button-outlined p-button-info m-1 py-1 "
            icon="pi pi-pencil"
          ></p-button>
          <p-button
            styleClass="p-button-outlined p-button-danger m-1 py-1 "
            icon="pi pi-trash"
          ></p-button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
